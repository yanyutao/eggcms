var f=(e,t,o)=>new Promise((i,p)=>{var l=r=>{try{c(o.next(r))}catch(u){p(u)}},h=r=>{try{c(o.throw(r))}catch(u){p(u)}},c=r=>r.done?i(r.value):Promise.resolve(r.value).then(l,h);c((o=o.apply(e,t)).next())});import{Y as C,P as b,v as S,M as x}from"./@element-plus.js";import{s as D,d as v}from"./tag.js";import{_ as E}from"./index.js";import{a5 as n,o as V,c as $,Y as a,R as s,F as q,W as g}from"./@vue.js";import"./api.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";const P={name:"tag-index",setup(){return{Edit:C,Delete:b,View:S,Search:x}},data:()=>({tableData:[],multipleSelection:[],count:0,cur:1,keywords:""}),computed:{},created(){let{cur:e=1,keywords:t=""}=this.$route.query;this.cur=+e,this.keywords=t,this.search()},watch:{$route(e,t){if(e.name=="tag-index"){let{cur:o,keywords:i}=e.query;this.cur=+o,this.keywords=i,this.search()}}},methods:{clearSearch(){this.$router.replace({name:"tag-index",query:{cur:1,cid:0,keywords:""}})},doSearch(){this.$router.replace({name:"tag-index",query:{cur:this.cur,keywords:this.keywords}}),this.search()},search(){return f(this,null,function*(){try{let e=yield D(this.cur,this.keywords);e.code===200&&(this.tableData=[...e.data.list],this.count=e.data.count)}catch(e){console.log(e)}})},handleCurrentChange(e){this.cur=+e,this.doSearch()},toggleSelection(e){e?e.forEach(t=>{this.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toEdit(e){let t=e.id;this.$router.push({name:"tag-edit",params:{id:t}})},handleDel(e){return f(this,null,function*(){let t=e.id;try{let o=yield v(t);o.code===200?(this.$message({message:"\u6587\u7AE0\u5220\u9664\u6210\u529F ^_^",type:"success"}),this.search()):this.$message({message:o.msg,type:"error"})}catch(o){console.log(o)}})}}},T=g("\u641C\u7D22"),j=g("\u65B0\u589E");function z(e,t,o,i,p,l){const h=n("el-input"),c=n("el-button"),r=n("el-col"),u=n("router-link"),_=n("el-row"),m=n("el-table-column"),y=n("el-table"),k=n("el-pagination");return V(),$(q,null,[a(_,{type:"flex",justify:"space-between"},{default:s(()=>[a(r,{span:18},{default:s(()=>[a(h,{class:"mr-10 w-auto",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9","suffix-icon":i.Search,clearable:"",onClear:l.clearSearch,modelValue:e.keywords,"onUpdate:modelValue":t[0]||(t[0]=d=>e.keywords=d)},null,8,["suffix-icon","onClear","modelValue"]),a(c,{type:"primary",onClick:l.search,round:""},{default:s(()=>[T]),_:1},8,["onClick"])]),_:1}),a(u,{class:"c-fff add-btn",to:"/tag/add"},{default:s(()=>[j]),_:1})]),_:1}),a(y,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark","row-key":"id",size:"small",onSelectionChange:l.handleSelectionChange},{default:s(()=>[a(m,{type:"selection"}),a(m,{prop:"id",label:"\u7F16\u53F7"}),a(m,{prop:"name",label:"\u540D\u79F0"}),a(m,{prop:"path",label:"\u6807\u8BC6"}),a(m,{fixed:"right",label:"\u64CD\u4F5C"},{default:s(d=>[a(c,{icon:i.Edit,circle:"",onClick:w=>l.toEdit(d.row)},null,8,["icon","onClick"]),a(c,{icon:i.Delete,circle:"",onClick:w=>l.handleDel(d.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"]),a(_,{type:"flex",class:"mt-20 align-c",justify:"center"},{default:s(()=>[a(k,{background:"",layout:"prev, pager, next",onCurrentChange:l.handleCurrentChange,"pager-size":10,total:e.count,currentPage:e.cur,"onUpdate:currentPage":t[1]||(t[1]=d=>e.cur=d),"hide-on-single-page":""},null,8,["onCurrentChange","total","currentPage"])]),_:1})],64)}const ae=E(P,[["render",z]]);export{ae as default};
