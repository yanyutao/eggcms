var H=Object.defineProperty;var I=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var P=(e,l,d)=>l in e?H(e,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[l]=d,D=(e,l)=>{for(var d in l||(l={}))Q.call(l,d)&&P(e,d,l[d]);if(I)for(var d of I(l))W.call(l,d)&&P(e,d,l[d]);return e};var _=(e,l,d)=>new Promise((f,y)=>{var i=m=>{try{c(d.next(m))}catch(s){y(s)}},v=m=>{try{c(d.throw(m))}catch(s){y(s)}},c=m=>m.done?f(m.value):Promise.resolve(m.value).then(i,v);c((d=d.apply(e,l)).next())});import{a as X}from"./category.js";import{f as Y,c as j}from"./article.js";import{s as G}from"./tag.js";import{_ as J,a as N,t as K,c as M,f as Z}from"./index.js";import{B as $}from"./BaseEditor.js";import{a5 as r,o as V,c as k,a as p,Y as o,R as t,F as w,S as B,T as E,a8 as T,W as u,Q as h,X as x}from"./@vue.js";import"./api.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";import"./@wangeditor.js";import"./mitt.js";const ee={name:"article-add",components:{BasicEditor:$},data:()=>({categorySelected:[-1],categoryProps:{checkStrictly:!0},activeName:"first",activeIndex:"0",category:[],cateList:[],autoImg:!0,autoDes:!0,picNum:1,taglist:[],params:{cid:0,sub_cid:[],title:"",short_title:"",tag_id:"",attr:[],seo_title:"",seo_keywords:"",seo_description:"",source:"",author:"",description:"",img:"",createdAt:new Date,updatedAt:new Date,content:"eggcms",status:"0",pv:0,link:""},field:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,paramsRules:{title:[{required:!0,message:"\u8BF7\u8F93\u5165\u680F\u76EE\u540D\u79F0",trigger:"blur"},{min:2,max:50,message:"\u540D\u79F0\u957F\u5EA6\u5728 2 \u5230 50 \u4E2A\u5B57\u7B26\u4E4B\u95F4",trigger:"blur"}]},cur:1,keywords:""}),computed:{},mounted(){},created(){this.query(),this.searchTag()},unmounted(){},methods:{handleClick(e){this.activeIndex=e.index},setContent(e){this.params.content=e},searchTag(e){return _(this,null,function*(){try{let l=yield G(this.cur,e);if(l.code===200){console.log("res--->",l.data.list);let d=[];l.data.list.forEach(f=>{d.push({label:f.name,value:f.id})}),this.taglist=d}}catch(l){console.log(l)}})},query(){return _(this,null,function*(){try{let e=yield X();if(e.code===200){let l=N(K(e.data)),d=N(e.data);this.cateList=d,this.category=[{label:"\u9009\u62E9\u680F\u76EE",value:-1},...l]}}catch(e){console.log(e)}})},handleChange(e){console.log(e),e[0]!=-1?(this.params.cid=e[e.length-1],this.findField(this.params.cid)):this.field=[]},handleAttr(e){console.log("e-->",e)},handleSubCid(e){console.log("e-->",e)},upload(e){this.params.img=e.link},handleRemove(e){console.log(e)},handlePictureCardPreview(e){console.log("file--<",e),this.dialogImageUrl=location.origin+e.response.link,this.dialogVisible=!0},handleDownload(e){console.log(e)},findField(e){return _(this,null,function*(){try{let l=yield Y(e);l.code===200&&(this.field=l.data.fields)}catch(l){console.log(l)}})},create(){return _(this,null,function*(){try{let e=D({},this.params);e.attr=e.attr.toString(),e.sub_cid=e.sub_cid.toString(),e.tag_id=e.tag_id.toString(),e.img||(e.img=M(e.content)[0]),e.description||(e.description=Z(e.content).substr(0,255));let l={};this.field.map(f=>{l[f.field_ename]=f.field_values}),(yield j({defaultParams:e,fieldParams:l})).code&&(this.$message({message:"\u66F4\u65B0\u6210\u529F^_^",type:"success"}),this.$router.go(-1))}catch(e){console.log(e)}})},submit(e){this.$refs[e].validate(l=>{if(l)this.create();else return console.log("error submit!!"),!1})}}},le={class:"mr-10 ml-10"},ae={class:"mr-10 ml-10 mb-20"},oe=u("\u5934\u6761"),te=u("\u63A8\u8350"),se=u("\u8F6E\u64AD"),de=u("\u70ED\u95E8"),re=p("i",{class:"el-icon-plus"},null,-1),ne=["src"],ie=p("p",null,"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A640px*320px\u3001420*160\u3001240*120\uFF0C\u56FE\u7247\u5C3A\u5BF8\u5728100k\u5185\u3002",-1),ue=u(" \u63D0\u53D6\u7B2C "),me=u("\u5F20\u56FE\u7247\u4F5C\u5C01\u9762 "),pe=u("\u63D0\u53D6\u6587\u7AE0\u63CF\u8FF0"),fe=u("\u53D1\u5E03"),Ve=u("\u4E0D\u53D1\u5E03"),ge={class:"w-640"},ce=p("p",{class:"tips"},"(\u53EF\u9009\u53D1\u5E03\u5230\u5176\u5B83\u680F\u76EE)",-1),be=u("\u4FDD\u5B58");function _e(e,l,d,f,y,i){const v=r("el-tab-pane"),c=r("el-tabs"),m=r("el-cascader"),s=r("el-form-item"),n=r("el-input"),g=r("el-checkbox"),C=r("el-checkbox-group"),A=r("el-select-v2"),F=r("el-upload"),L=r("el-dialog"),R=r("BasicEditor"),q=r("el-date-picker"),S=r("el-radio"),O=r("el-button"),z=r("el-form");return V(),k(w,null,[p("div",le,[o(c,{modelValue:e.activeName,"onUpdate:modelValue":l[0]||(l[0]=a=>e.activeName=a),onTabClick:i.handleClick},{default:t(()=>[o(v,{label:"\u57FA\u672C\u4FE1\u606F",name:"first"}),o(v,{label:"\u6269\u5C55\u4FE1\u606F",name:"second"})]),_:1},8,["modelValue","onTabClick"])]),p("div",ae,[o(z,{ref:"params",model:e.params,rules:e.paramsRules,"label-width":"100px",class:""},{default:t(()=>[B(p("div",null,[o(s,{label:"\u6587\u7AE0\u680F\u76EE"},{default:t(()=>[o(m,{props:e.categoryProps,"show-all-levels":!1,modelValue:e.categorySelected,"onUpdate:modelValue":l[1]||(l[1]=a=>e.categorySelected=a),options:e.category,onChange:i.handleChange},null,8,["props","modelValue","options","onChange"])]),_:1}),o(s,{label:"\u6587\u7AE0\u6807\u9898",prop:"title"},{default:t(()=>[o(n,{modelValue:e.params.title,"onUpdate:modelValue":l[2]||(l[2]=a=>e.params.title=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u5185\u5BB9\u5C5E\u6027"},{default:t(()=>[o(C,{modelValue:e.params.attr,"onUpdate:modelValue":l[3]||(l[3]=a=>e.params.attr=a),onChange:i.handleAttr},{default:t(()=>[o(g,{label:"1"},{default:t(()=>[oe]),_:1}),o(g,{label:"2"},{default:t(()=>[te]),_:1}),o(g,{label:"3"},{default:t(()=>[se]),_:1}),o(g,{label:"4"},{default:t(()=>[de]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1}),o(s,{label:"tag\u6807\u7B7E"},{default:t(()=>[o(A,{modelValue:e.params.tag_id,"onUpdate:modelValue":l[4]||(l[4]=a=>e.params.tag_id=a),options:e.taglist,placeholder:"Please select",style:{width:"240px"},multiple:"",filterable:"",remote:"","remote-method":i.searchTag},null,8,["modelValue","options","remote-method"])]),_:1}),o(s,{label:"\u5185\u5BB9\u6458\u8981"},{default:t(()=>[o(n,{type:"textarea",rows:2,placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:e.params.description,"onUpdate:modelValue":l[5]||(l[5]=a=>e.params.description=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u7F29\u7565\u56FE"},{default:t(()=>[o(F,{action:"/api/upload","list-type":"picture-card","on-preview":i.handlePictureCardPreview,"on-remove":i.handleRemove,"on-success":i.upload},{default:t(()=>[re]),_:1},8,["on-preview","on-remove","on-success"]),o(L,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[6]||(l[6]=a=>e.dialogVisible=a)},{default:t(()=>[p("img",{width:"480",src:e.dialogImageUrl,alt:""},null,8,ne)]),_:1},8,["modelValue"]),ie]),_:1}),o(s,{label:"\u6587\u7AE0\u5185\u5BB9"},{default:t(()=>[o(R,{content:e.params.content,onSetContent:i.setContent},null,8,["content","onSetContent"])]),_:1}),o(s,{label:"\u5185\u5BB9\u529F\u80FD"},{default:t(()=>[o(g,{modelValue:e.autoImg,"onUpdate:modelValue":l[8]||(l[8]=a=>e.autoImg=a)},{default:t(()=>[ue,o(n,{modelValue:e.picNum,"onUpdate:modelValue":l[7]||(l[7]=a=>e.picNum=a),class:"w-80 mr-8 ml-8",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"]),me]),_:1},8,["modelValue"]),o(g,{modelValue:e.autoDes,"onUpdate:modelValue":l[9]||(l[9]=a=>e.autoDes=a)},{default:t(()=>[pe]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"\u53D1\u5E03\u65F6\u95F4"},{default:t(()=>[o(q,{modelValue:e.params.createdAt,"onUpdate:modelValue":l[10]||(l[10]=a=>e.params.createdAt=a),"default-value":new Date,type:"datetime",placeholder:"\u9009\u62E9\u65E5\u671F\u65F6\u95F4"},null,8,["modelValue","default-value"])]),_:1}),o(s,{label:"\u662F\u5426\u663E\u793A"},{default:t(()=>[o(S,{modelValue:e.params.status,"onUpdate:modelValue":l[11]||(l[11]=a=>e.params.status=a),label:"0"},{default:t(()=>[fe]),_:1},8,["modelValue"]),o(S,{modelValue:e.params.status,"onUpdate:modelValue":l[12]||(l[12]=a=>e.params.status=a),label:"1"},{default:t(()=>[Ve]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"\u6D4F\u89C8\u6570"},{default:t(()=>[o(n,{modelValue:e.params.pv,"onUpdate:modelValue":l[13]||(l[13]=a=>e.params.pv=a)},null,8,["modelValue"])]),_:1})],512),[[E,e.activeIndex==0]]),B(p("div",null,[o(s,{label:"\u77ED\u6807\u9898",prop:"name"},{default:t(()=>[o(n,{modelValue:e.params.short_title,"onUpdate:modelValue":l[14]||(l[14]=a=>e.params.short_title=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u5176\u5B83\u680F\u76EE"},{default:t(()=>[p("div",ge,[o(C,{modelValue:e.params.sub_cid,"onUpdate:modelValue":l[15]||(l[15]=a=>e.params.sub_cid=a),onChange:i.handleSubCid},{default:t(()=>[(V(!0),k(w,null,T(e.cateList,(a,U)=>(V(),h(g,{key:U,label:a.value},{default:t(()=>[u(x(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","onChange"]),ce])]),_:1}),o(s,{label:"SEO\u6807\u9898"},{default:t(()=>[o(n,{modelValue:e.params.seo_title,"onUpdate:modelValue":l[16]||(l[16]=a=>e.params.seo_title=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"SEO\u5173\u952E\u8BCD"},{default:t(()=>[o(n,{modelValue:e.params.seo_keywords,"onUpdate:modelValue":l[17]||(l[17]=a=>e.params.seo_keywords=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"SEO\u63CF\u8FF0"},{default:t(()=>[o(n,{modelValue:e.params.seo_description,"onUpdate:modelValue":l[18]||(l[18]=a=>e.params.seo_description=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u6765\u6E90"},{default:t(()=>[o(n,{modelValue:e.params.source,"onUpdate:modelValue":l[19]||(l[19]=a=>e.params.source=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u4F5C\u8005"},{default:t(()=>[o(n,{modelValue:e.params.author,"onUpdate:modelValue":l[20]||(l[20]=a=>e.params.author=a)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u5916\u94FE\u8DF3\u8F6C"},{default:t(()=>[o(n,{modelValue:e.params.link,"onUpdate:modelValue":l[21]||(l[21]=a=>e.params.link=a),max:"120"},null,8,["modelValue"])]),_:1}),(V(!0),k(w,null,T(e.field,(a,U)=>(V(),h(s,{label:a.field_cname,key:U},{default:t(()=>[a.field_type==="1"?(V(),h(n,{key:0,modelValue:a.field_values,"onUpdate:modelValue":b=>a.field_values=b,max:"120"},null,8,["modelValue","onUpdate:modelValue"])):a.field_type==="2"?(V(),h(n,{key:1,type:"textarea",rows:3,placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:a.field_values,"onUpdate:modelValue":b=>a.field_values=b},null,8,["modelValue","onUpdate:modelValue"])):(V(),h(n,{key:2,type:"textarea",rows:3,placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",autosize:"false",modelValue:a.field_values,"onUpdate:modelValue":b=>a.field_values=b},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))],512),[[E,e.activeIndex==1]]),o(s,null,{default:t(()=>[o(O,{type:"primary",onClick:l[22]||(l[22]=a=>i.submit("params"))},{default:t(()=>[be]),_:1})]),_:1})]),_:1},8,["model","rules"])])],64)}const Ye=J(ee,[["render",_e]]);export{Ye as default};
