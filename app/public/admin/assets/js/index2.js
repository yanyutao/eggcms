var _=(e,t,i)=>new Promise((h,y)=>{var n=s=>{try{r(i.next(s))}catch(m){y(m)}},g=s=>{try{r(i.throw(s))}catch(m){y(m)}},r=s=>s.done?h(s.value):Promise.resolve(s.value).then(n,g);r((i=i.apply(e,t)).next())});import{Y as S,P as D,v,M as V}from"./@element-plus.js";import{s as x,f as E,d as T}from"./category.js";import{_ as B,t as $,a as j}from"./index.js";import{a5 as d,aj as F,o as p,c as u,Y as l,R as a,S as N,Q as R,F as Y,W as f,X as q}from"./@vue.js";import"./api.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";const z={name:"category-index",setup(){return{Edit:S,Delete:D,View:v,Search:V}},data:()=>({keywords:"",loading:!0,tableData:[],multipleSelection:[]}),computed:{},created(){this.search()},methods:{clearSearch(){this.keywords="",this.tableData=[],this.multipleSelection=[],this.search()},search(){return _(this,null,function*(){try{const e=this.keywords;let t=yield x(e);if(t.code===200){let i=$(t.data);console.log("data->",i),this.tableData=j(i),this.loading=!1}}catch(e){console.log(e)}})},toggleSelection(e){e?e.forEach(t=>{this.$refs.multipleTable.toggleRowSelection(t)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toEdit(e){let t=e.id;this.$router.push({name:"category-edit",params:{id:t}})},hasChild(e){return _(this,null,function*(){try{let t=yield E(e);if(t.code===200)return t.data.length>0}catch(t){console.log(t)}})},del(e){return _(this,null,function*(){try{(yield T(e)).code===200&&(this.$message({message:"\u680F\u76EE\u5220\u9664\u6210\u529F ^_^",type:"success"}),this.clearSearch())}catch(t){console.log(t)}})},delSome(){},handleDel(e){let t=e.id;if(this.hasChild(t).length>0)return this.$message({message:"\u6211\u4E0B\u9762\u8FD8\u6709\u680F\u76EE\u554A ^_^",type:"success"}),!1;this.del(t)}}},I=f("\u641C\u7D22"),L=f("\u6E05\u7A7A"),M=f("\u65B0\u589E"),P={key:0},Q={key:1},U={key:0},W={key:1};function X(e,t,i,h,y,n){const g=d("el-input"),r=d("el-button"),s=d("el-col"),m=d("router-link"),w=d("el-row"),c=d("el-table-column"),b=d("el-table"),C=F("loading");return p(),u(Y,null,[l(w,{type:"flex",justify:"space-between"},{default:a(()=>[l(s,{span:18},{default:a(()=>[l(g,{class:"mr-10 w-auto",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9","suffix-icon":h.Search,modelValue:e.keywords,"onUpdate:modelValue":t[0]||(t[0]=o=>e.keywords=o)},null,8,["suffix-icon","modelValue"]),l(r,{type:"primary",onClick:n.search,round:""},{default:a(()=>[I]),_:1},8,["onClick"]),l(r,{onClick:n.clearSearch,round:""},{default:a(()=>[L]),_:1},8,["onClick"])]),_:1}),l(m,{class:"c-fff add-btn",to:"/category/add"},{default:a(()=>[M]),_:1})]),_:1}),N((p(),R(b,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark","row-key":"id",size:"small","tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:n.handleSelectionChange},{default:a(()=>[l(c,{type:"selection"}),l(c,{prop:"id",label:"\u7F16\u53F7"}),l(c,{prop:"name",label:"\u540D\u79F0"}),l(c,{prop:"type",label:"\u7C7B\u578B"},{default:a(o=>[o.row.type==0?(p(),u("p",P,"\u680F\u76EE")):(p(),u("p",Q,"\u5355\u9875"))]),_:1}),l(c,{prop:"sort",label:"\u6392\u5E8F"},{default:a(o=>[f(q(o.row.sort),1)]),_:1}),l(c,{prop:"status",label:"\u72B6\u6001"},{default:a(o=>[o.row.status==0?(p(),u("p",U,"\u663E\u793A")):(p(),u("p",W,"\u9690\u85CF"))]),_:1}),l(c,{fixed:"right",label:"\u64CD\u4F5C",width:"160"},{default:a(o=>[l(r,{icon:h.View,circle:"",onClick:k=>e.handleClick(o.row)},null,8,["icon","onClick"]),l(r,{icon:h.Edit,circle:"",onClick:k=>n.toEdit(o.row)},null,8,["icon","onClick"]),l(r,{icon:h.Delete,circle:"",onClick:k=>n.handleDel(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[C,e.loading]])],64)}const ue=B(z,[["render",X]]);export{ue as default};
