var n=(t,s,a)=>new Promise((_,p)=>{var r=i=>{try{c(a.next(i))}catch(m){p(m)}},o=i=>{try{c(a.throw(i))}catch(m){p(m)}},c=i=>i.done?_(i.value):Promise.resolve(i.value).then(r,o);c((a=a.apply(t,s)).next())});import{h as u,a as g}from"./api.js";import{_ as v,s as f}from"./index.js";import{o as y,c as b,a as e,S as d,ak as h,aa as k,aw as C,ax as L,W as w}from"./@vue.js";import"./axios.js";import"./element-plus.js";import"./lodash-es.js";import"./@vueuse.js";import"./@element-plus.js";import"./@popperjs.js";import"./@ctrl.js";import"./dayjs.js";import"./async-validator.js";import"./memoize-one.js";import"./escape-html.js";import"./normalize-wheel-es.js";import"./@floating-ui.js";import"./pinia.js";import"./vue-router.js";import"./js-cookie.js";let $=({username:t,password:s})=>u({url:`${g.API_URL}/api/admin/login`,method:"post",data:{username:t,password:s}}),I=t=>u({url:`${g.API_URL}/api/captcha?v=${t}`,method:"get"}),U=t=>u({url:`${g.API_URL}/api/checkCaptcha`,method:"post",data:{captcha:t}});const x=""+new URL("../png/banner.png",import.meta.url).href;const S={name:"login-in",data:()=>({svg:"",code:"",params:{username:"",password:""}}),computed:{},created(){this.getCaptcha()},mounted(){},methods:{getCaptcha(){return n(this,null,function*(){try{let t=Math.random().toString().slice(4,8),s=yield I(t);this.svg=s}catch(t){console.log(t)}})},checkCaptcha(){return n(this,null,function*(){try{return(yield U(this.code)).data.data?!0:(this.$message({message:"\u9A8C\u8BC1\u7801\u4E0D\u6B63\u786E",type:"warning"}),!1)}catch(t){console.log(t)}})},validate(){return this.params.username.length<2?(this.$message({message:"\u7528\u6237\u540D\u4E0D\u80FD\u5C11\u4E8E2\u4F4D",type:"warning"}),!1):this.params.password.length<6?(this.$message({message:"\u5BC6\u7801\u4E0D\u80FD\u5C11\u4E8E6\u4F4D",type:"warning"}),!1):!0},toLogin(){return n(this,null,function*(){if(this.validate()){if(!(yield this.checkCaptcha()))return;$({username:this.params.username,password:this.params.password}).then(a=>{if(console.log("res--->",a),a.code===200&&a.data){f("username",a.data.username),f("token",a.data.token),this.$router.push({name:"home-index"});return}this.$message({message:"\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF",type:"warning"})}).catch(a=>{console.error(a)})}})}}},l=t=>(C("data-v-9e04404d"),t=t(),L(),t),V={class:"ys-wrap page-login pt-160 row"},M=l(()=>e("div",{class:"login-ad mt-35 col-12"},[e("img",{src:x,alt:""})],-1)),R={class:"login-form col-12"},T=l(()=>e("div",{class:"ys-logo mb-30 text-c"},null,-1)),A={class:"w-330"},B={class:"border-b pt-8 pb-8 mb-10 pos-r"},P=l(()=>e("i",{class:"ico ico-user pos-r t-2"},null,-1)),H={class:"border-b pt-8 pb-8 mb-10 pos-r"},K=l(()=>e("i",{class:"ico ico-pass pos-r t-2"},null,-1)),N={class:"mb-10 pos-r captcha"},D=["innerHTML"],E={class:"mt-21"},W=l(()=>e("footer",{class:"ys-footer"},[e("p",{class:"f-13 c-a1a3aa text-c"},[w(" \xA9 "),e("a",{href:"http://www.eggcms.top",class:"mr-5",target:"_blank",title:"yuscms"},"www.eggcms.top"),w(" eggcms\u7CFB\u7EDF \u25CF \u4F4D\u4E8E\u5357\u4EAC \u670D\u52A1\u5168\u56FD ")])],-1));function j(t,s,a,_,p,r){return y(),b("div",null,[e("div",V,[M,e("div",R,[T,e("ul",A,[e("li",B,[P,d(e("input",{type:"text",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[0]||(s[0]=o=>t.params.username=o),placeholder:"\u7528\u6237\u540D"},null,512),[[h,t.params.username]])]),e("li",H,[K,d(e("input",{type:"password",class:"ml-10 f-14 lh-20 c-333","onUpdate:modelValue":s[1]||(s[1]=o=>t.params.password=o),placeholder:"\u5BC6\u7801",onKeyup:s[2]||(s[2]=k((...o)=>r.toLogin&&r.toLogin(...o),["enter"]))},null,544),[[h,t.params.password]])]),e("li",N,[d(e("input",{type:"text",class:"f-14 lh-20 c-333 code","onUpdate:modelValue":s[3]||(s[3]=o=>t.code=o),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,512),[[h,t.code]]),e("span",{innerHTML:t.svg},null,8,D),e("span",{onClick:s[4]||(s[4]=(...o)=>r.getCaptcha&&r.getCaptcha(...o)),class:"see"},"\u770B\u4E0D\u6E05\uFF0C\u6362\u4E00\u5F20")]),e("li",E,[e("input",{type:"submit",onClick:s[5]||(s[5]=(...o)=>r.toLogin&&r.toLogin(...o)),class:"btn-block f-16 c-fff lh-22",value:"\u767B\u5F55"})])])])]),W])}const ct=v(S,[["render",j],["__scopeId","data-v-9e04404d"]]);export{ct as default};
